<!DOCTYPE html><!--lLKmyGbgC9GZXyGPxKThQ--><html lang="en"><head><meta charSet="UTF-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/images/ccsr-bugfix/bug.gif"/><link rel="preload" as="image" href="/images/ccsr-bugfix/decomp.png"/><link rel="preload" as="image" href="/images/ccsr-bugfix/lingohex.png"/><link rel="preload" as="image" href="/images/ccsr-bugfix/maphex.png"/><link rel="preload" as="image" href="/images/ccsr-bugfix/dialogue.png"/><link rel="preload" as="image" href="/images/ccsr-bugfix/boathex1.png"/><link rel="preload" as="image" href="/images/ccsr-bugfix/replace.png"/><link rel="preload" as="image" href="/images/ccsr-bugfix/bugfix.gif"/><link rel="preload" as="image" href="/images/ccsr-bugfix/fixed.gif"/><link rel="stylesheet" href="/_next/static/css/0f63a619df29c78b.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/5eacd01f773eed7f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-6b8b512d4121474e.js"/><script src="/_next/static/chunks/4bd1b696-c023c6e3521b1417.js" async=""></script><script src="/_next/static/chunks/255-a7ba4d37dca2f1fa.js" async=""></script><script src="/_next/static/chunks/main-app-bdb7cdcf0fbe007a.js" async=""></script><script src="/_next/static/chunks/619-ba102abea3e3d0e4.js" async=""></script><script src="/_next/static/chunks/app/%5Bslug%5D/page-a8d66757df33bd31.js" async=""></script><title>Fixing a bug in an 18 year old Shockwave game - Matt&#x27;s Blog</title><meta name="description" content="The story of changing a single byte"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body id="main" class="main px-5 pb-10 max-w-5xl m-auto"><div hidden=""><!--$--><!--/$--></div><div><div class="flex flex-wrap p-1 sm:p-3"><a class="mx-3 p-1 sm:px-3 sm:py-2 rounded-lg hover:bg-gray-200 transition-all font-bold" href="/">Blog</a><a class="mx-3 p-1 sm:px-3 sm:py-2 rounded-lg hover:bg-gray-200 transition-all font-normal" href="/projects/">Projects</a><a class="mx-3 p-1 sm:px-3 sm:py-2 rounded-lg hover:bg-gray-200 transition-all font-normal" href="/travel/">Travel</a><a class="mx-3 p-1 sm:px-3 sm:py-2 rounded-lg hover:bg-gray-200 transition-all font-normal" href="/about/">About Me</a><a class="mx-3 p-1 sm:px-3 sm:py-2 rounded-lg hover:bg-gray-200 transition-all " target="_blank" href="https://docs.google.com/forms/d/e/1FAIpQLScM11T5L9SjhZ1c9A3OB7aWc6DuLYTzf9DStnFkalDKaKDpaA/viewform?usp=sharing&amp;ouid=112011499277324502181">Contact</a></div><div class="md:flex md:justify-center"><article class="prose md:prose-lg lg:prose-xl mt-16"><h1 class="mb-0">Fixing a bug in an 18 year old Shockwave game</h1><div class="italic text-gray-500">The story of changing a single byte</div><div class="text-gray-400">October 6, 2018</div><div class="mt-6"><blockquote>
<p>It felt like unearthing a buried tomb and finding an untouched puzzle inside.
One that would have otherwise been lost to time without ever being solved.</p>
</blockquote>
<h2>Cartoon Cartoon Summer Resort</h2>
<p>It was the summer of 2000.
I was 6 years old, and
I had just passed the 1<sup>st</sup> grade and starting summer break.
This meant long days of playing outside, watching cartoon marathons,
and booting up my dad&#x27;s Windows 98 computer to browse for games to play
on a brand new frontier called the &quot;Internet&quot;.
Cartoon Network&#x27;s website was one of my favorites.
They had immersive flash games that were designed around the cartoons on TV.
That summer they released a series of games called &quot;Cartoon Cartoon Summer Resort&quot;.</p>
<iframe width="100%" height="400px" src="https://www.youtube.com/embed/JcEcJpV6Rvs" allow="autoplay; encrypted-media" allowFullScreen=""></iframe>
<div class="subtitle"><p>Gameplay of the first Episode of Cartoon Cartoon Summer Resort</p></div>
<p>The game was a top-down 2D RPG/adventure game that had 4 episodes.
You played as a cartoon character who is on vacation at a resort with other cartoon characters.
In each episode there is a problem to solve at the resort.
You must help solve it by interacting with the characters and finding/trading items.</p>
<h2>Fast forward 18 years</h2>
<p>I remembered this game a while ago during a nostalga trip and I knew that I had to play it again.
The game is nearly 2 decades old so it was hard to find a working link.</p>
<p>Also, no modern browser would run the ancient and vulnerability prone Shockwave player... except for Internet Explorer.
I may be the first person to have finally found a legitimate reason to use Internet Exploerer in 2018.</p>
<p>After playing the game for a bit, There were some things that became impossible to ignore.
For example, the repetitive background music that plays in an infinite loop, and the poor collision detection.</p>
<h2>The Bug</h2>
<p>After a while I discovered a bug in the game:</p>
<p><strong>Walking in areas where nothing should happen would sometimes prompt game dialogue to appear.</strong></p>
<p>As you can see below, you are able to rent a boat in the game to travel on the water.
When trying to rent another boat, it says &quot;No more boats to rent today!&quot;.
If you travel north and walk along the right edge of the island,
it will randomly trigger the same text that was meant for the boat dock.</p>
<div class="image-row"><p><img src="/images/ccsr-bugfix/bug.gif" alt=""/></p></div>
<p>Now at this point, any sane person with a healthy respsect for their time and energy
would write this off as a mild annoyance, remind themselves that
this was a low-budget web game made for children 2 decades ago, and continue playing.
But not me.</p>
<p>Looking at the game with the knowledge I now have of programming,
I found this ancient bug oddly mesmerizing.
It felt like unearthing a buried tomb and finding an untouched puzzle inside.
One that would have otherwise been lost to time without ever being solved.
For me, fixing this bug was an opportunity for learning and discovery.
Interestingly, this is exactly what <em>playing</em> the game offered to me as a kid.
It&#x27;s poetic how something can unintentionally offer entirely new challenges depending on how you look at it.</p>
<h2>Deconstructing the Game</h2>
<p>In order to fix the bug, I needed to figure out how the game worked under the hood.
After doing some research, I learned that the game was a Shockwave game made with <a href="https://en.wikipedia.org/wiki/Adobe_Director" target="_blank" class="underline">Director</a>.
When using Director, projects are saved as a <code>.dir</code> (Director) file.
This file is similar to a PSD file for Photoshop.
In the same way that a PSD file would hold non-destructive layer and text information,
the <code>.dir</code> project saves all assets, raw source code, and other information to aide in the development process.
Director used a proprietary scripting language called
<a href="https://en.wikipedia.org/wiki/Lingo_(programming_language)" target="_blank">Lingo</a>
to animate scenes.</p>
<p>If the game was saved as a <code>.dir</code> file, I would simply be able to open it
in Director and easily see how the game works.
However, the game was published as a <code>.dcr</code> file.
The <code>.dcr</code> file is a compiled version of a Director project.
This means that all of the source code has been compiled into bytecode that runs on the Shockwave platform.
This process is similar to how a PSD file can be flattened into a PNG image.
The PNG image (DCR file in this case) is smaller, has no layer or editing information, and is only meant to be distributed.</p>
<p>This meant that I was stuck with a 500kB binary blob with no documentation on how it was structured.
Even if I did figure out how to find the low-level bytecode,
it didn&#x27;t look like there was anyone who
had reverse engineered Lingo bytecode or even documented how the Shockwave platform works.
All of this information is proprietary and owned by Adobe who has no reason to release it.
The prospects of figuring out how this game worked were looking pretty grim.</p>
<h2>Decompression</h2>
<p>After feeling defeated by the fact that I wasn&#x27;t likely going to be able to solve the bug, I decided
to see if there was any possible way to extract assets out of the game.
I figured that there might be a chance I could find a compressed data section or something similar.
After looking around, I found a few programs called <a href="https://aluigi.altervista.org/mytoolz.htm" target="_blank" class="underline">offzip and packzip</a>.
These tools are able to search for zlib data in arbitrary binary files, show you the offsets,
and extract them to separate files if they exist.</p>
<p>I ran offzip on the DCR file and to my amazement it actually found archives!
249 to be exact.</p>
<pre><code class="hljs language-apache">$ ./<span class="hljs-attribute">offzip</span>.exe -a <span class="hljs-number">1</span>.dcr

- <span class="hljs-attribute">open</span> input file:    <span class="hljs-number">1</span>.dcr
- <span class="hljs-attribute">zip</span> data to check:  <span class="hljs-number">32</span> bytes
- <span class="hljs-attribute">zip</span> windowBits:     <span class="hljs-number">15</span>
- <span class="hljs-attribute">seek</span> offset:        <span class="hljs-number">0</span>x00000000  (<span class="hljs-number">0</span>)
+------------+-----+----------------------------+----------------------+
| <span class="hljs-attribute">hex_offset</span> | ... | zip -&gt; unzip size / offset | spaces before | info |
+------------+-----+----------------------------+----------------------+
  <span class="hljs-attribute">0x00000026</span> . <span class="hljs-number">164</span> -&gt; <span class="hljs-number">214</span> / <span class="hljs-number">0</span>x000000ca _ <span class="hljs-number">38</span> <span class="hljs-number">8</span>:<span class="hljs-number">7</span>:<span class="hljs-number">26</span>:<span class="hljs-number">0</span>:<span class="hljs-number">1</span>:<span class="hljs-number">7</span>b6349f6
  <span class="hljs-attribute">0x000000d3</span> .. <span class="hljs-number">3932</span> -&gt; <span class="hljs-number">9169</span> / <span class="hljs-number">0</span>x0000102f _ <span class="hljs-number">9</span> <span class="hljs-number">8</span>:<span class="hljs-number">7</span>:<span class="hljs-number">26</span>:<span class="hljs-number">0</span>:<span class="hljs-number">1</span>:c1079d84
  ...
  <span class="hljs-attribute">0x00080490</span> . <span class="hljs-number">265</span> -&gt; <span class="hljs-number">472</span> / <span class="hljs-number">0</span>x00080599 _ <span class="hljs-number">0</span> <span class="hljs-number">8</span>:<span class="hljs-number">7</span>:<span class="hljs-number">26</span>:<span class="hljs-number">0</span>:<span class="hljs-number">1</span>:<span class="hljs-number">04</span>d6b43f
  <span class="hljs-attribute">0x00080599</span> . <span class="hljs-number">209</span> -&gt; <span class="hljs-number">366</span> / <span class="hljs-number">0</span>x0008066a _ <span class="hljs-number">0</span> <span class="hljs-number">8</span>:<span class="hljs-number">7</span>:<span class="hljs-number">26</span>:<span class="hljs-number">0</span>:<span class="hljs-number">1</span>:<span class="hljs-number">7</span>da3ba08


- <span class="hljs-attribute">249</span> valid compressed streams found
- <span class="hljs-attribute">0x0004040d</span> -&gt; <span class="hljs-number">0</span>x001565c8 bytes covering the <span class="hljs-number">50</span>% of the file
</code></pre>
<p>I extracted all of these files into a folder, and started looking at the results.
There were 206 <code>.dat</code> files, 38 <code>.fff</code> files, 4 <code>.atn</code> files, and a single <code>.ini</code> file.</p>
<p><img src="/images/ccsr-bugfix/decomp.png" alt=""/></p>
<h2>Discoveries</h2>
<p>I started with the INI file, but it had no value.
It was just a font mapping table for Directory 7.0 between Windows and Mac.
Next I moved on to the DAT files.
Most of these were 1KB in size, so I started with the huge one that was
144KB in size.
I opened it in a hex editor and looked around.
Most of it was unintelligible data.
However, eventually I found some words mixed in that appeared to be Lingo identifiers</p>
<p><img src="/images/ccsr-bugfix/lingohex.png" alt=""/></p>
<p>Sifting through the large DAT files provided me with a few clues,
and there were some interesting messages littered throughout it.
I found out that they likely used Photoshop 3.0 for the graphics.
They also had an internal map editing tool that was named
<code>Map-O-Matic v1</code>. I wish I could see what that looked like
and how it was made.</p>
<p>I also discovered the name of the company who made the game:
<a href="https://www.linkedin.com/company/funny-garbage/" target="_blank" class="underline">Funny Garbage</a>.
The lead developer&#x27;s name was also in the file, who&#x27;s name I will omit.
It felt good to solve the mystery of who made the game that I was furiously
trying to fix nearly 20 years later and to put a face to the person
who likely caused me this agony.
All of these tidbits of information were nice to find,
but they weren&#x27;t that helpful.</p>
<h2>Breakthrough</h2>
<p>Next, I looked at the <code>.fff</code> files in the hex editor.
To my great surprise, all of the data in these files
was legible AND it looked like map data:</p>
<div class="image-row"><p><img src="/images/ccsr-bugfix/maphex.png" alt=""/></p></div>
<p>I manually extracted some of this data and prettied it up in a text editor.
What I was left with was something that looks very similar to a JSON array:</p>
<pre><code class="hljs language-smalltalk">[
    <span class="hljs-symbol">#member</span>: <span class="hljs-comment">&quot;block.104&quot;</span>,
    <span class="hljs-symbol">#type</span>: <span class="hljs-symbol">#FLOR</span>,
    <span class="hljs-symbol">#location</span>: [<span class="hljs-number">16</span>, <span class="hljs-number">9</span>],
    <span class="hljs-symbol">#width</span>: <span class="hljs-number">64</span>,
    <span class="hljs-symbol">#WSHIFT</span>: <span class="hljs-number">0</span>,
    <span class="hljs-symbol">#height</span>: <span class="hljs-number">32</span>,
    <span class="hljs-symbol">#HSHIFT</span>: <span class="hljs-number">0</span>,
    <span class="hljs-symbol">#data</span>: [
        <span class="hljs-symbol">#item</span>: [
            <span class="hljs-symbol">#name</span>: <span class="hljs-comment">&quot;&quot;</span>,
            <span class="hljs-symbol">#type</span>: <span class="hljs-symbol">#WALL</span>,
            <span class="hljs-symbol">#visi</span>: [
                <span class="hljs-symbol">#visiObj</span>: <span class="hljs-comment">&quot;&quot;</span>,
                <span class="hljs-symbol">#visiAct</span>: <span class="hljs-comment">&quot;&quot;</span>,
                <span class="hljs-symbol">#inviObj</span>: <span class="hljs-comment">&quot;&quot;</span>,
                <span class="hljs-symbol">#inviAct</span>: <span class="hljs-comment">&quot;&quot;</span>
            ],
            <span class="hljs-symbol">#COND</span>: [[<span class="hljs-symbol">#hasObj</span>: <span class="hljs-comment">&quot;&quot;</span>, <span class="hljs-symbol">#hasAct</span>: <span class="hljs-comment">&quot;&quot;</span>, <span class="hljs-symbol">#giveObj</span>: <span class="hljs-comment">&quot;sunscreen&quot;</span>, <span class="hljs-symbol">#giveAct</span>: <span class="hljs-comment">&quot;gotscreen&quot;</span>], <span class="hljs-symbol">#none</span>, <span class="hljs-symbol">#none</span>, <span class="hljs-symbol">#none</span>]
        ],
        <span class="hljs-symbol">#move</span>: [<span class="hljs-symbol">#U</span>: <span class="hljs-number">0</span>, <span class="hljs-symbol">#d</span>: <span class="hljs-number">0</span>, <span class="hljs-symbol">#L</span>: <span class="hljs-number">0</span>, <span class="hljs-symbol">#R</span>: <span class="hljs-number">0</span>, <span class="hljs-symbol">#COND</span>: <span class="hljs-number">1</span>, <span class="hljs-symbol">#TIMEA</span>: <span class="hljs-number">0</span>, <span class="hljs-symbol">#TIMEB</span>: <span class="hljs-number">0</span>],
        <span class="hljs-symbol">#message</span>: [
            [<span class="hljs-symbol">#text</span>: <span class="hljs-comment">&quot;You bought the sun screen.&quot;</span>, <span class="hljs-symbol">#plrObj</span>: <span class="hljs-comment">&quot;&quot;</span>, <span class="hljs-symbol">#plrAct</span>: <span class="hljs-comment">&quot;&quot;</span>],
            [<span class="hljs-symbol">#text</span>: <span class="hljs-comment">&quot;No more sunscreen today!&quot;</span>, <span class="hljs-symbol">#plrObj</span>: <span class="hljs-comment">&quot;&quot;</span>, <span class="hljs-symbol">#plrAct</span>: <span class="hljs-comment">&quot;gotscreen&quot;</span>]
        ]
    ]
]
</code></pre>
<p>This was critical, because I was able to deduce a lot about how the game worked from this.</p>
<ol>
<li>The game expects its map, text, and event data in JSON-like Lingo Objects</li>
<li>Each <code>#member</code> entry is a tile, block, or character to be rendered.</li>
<li>The <code>#member</code>&#x27;s location offsets and dimensions are editable.</li>
</ol>
<p>Knowing that the game dialoge is saved in these files,
I wrote a quick line to extract only the dialogue into a file:
<code>grep -a -o &#x27;#text: &quot;[^&quot;]*&#x27; Uncompressed/*.fff | awk &#x27;{print $0,&quot;\r&quot;}&#x27; &gt; Dialogue.txt</code></p>
<p>Using this file, I could easily search for the offending text,
and also see which file it was in:</p>
<p><img src="/images/ccsr-bugfix/dialogue.png" alt=""/></p>
<p>The offending text is either in <code>0004eda0.fff</code> or <code>0004f396.fff</code>.
In this case, the bugged text is in the first file.
We know this because right under it is the message that you get
when interacting with Og, who is the character in the same map as the bugged tile.</p>
<h2>Fixing the Bug</h2>
<p>Now, I can open <code>0004eda0.fff</code> and search for the boat string in the hex editor.
Once I find that, I can find the <code>#member</code> object that&#x27;s associated with it.
I can now change its properties and save the file.
Afterwards, I can recompress and patch it back into the original game DCR by using <code>packzip</code>.</p>
<p><img src="/images/ccsr-bugfix/boathex1.png" alt=""/></p>
<p><code>$ ./packzip -o 0x0004EDA0 Uncompressed/0004eda0.fff test.dcr</code></p>
<p>When I change the block type from <code>block.11</code> to <code>block.13</code> and patch the game,
we can clearly see the outline of the messed up tile:</p>
<p><img src="/images/ccsr-bugfix/replace.png" alt=""/></p>
<div class="subtitle"><p>Changing the tile ID shows the bounds of the bugged area</p></div>
<p>The actual fix for the bug is laughably simple.
All I had to do was change the identifier for the <code>#message</code> to <code>#fessage</code> for that bugged tile:</p>
<p><img src="/images/ccsr-bugfix/bugfix.gif" alt=""/></p>
<p>Now, when we patch this in and walk back to that area,
THERE ARE NO MORE MESSAGES!!!</p>
<p><img src="/images/ccsr-bugfix/fixed.gif" alt=""/></p>
<div class="subtitle"><p>Fixing a bug in the game by literally editing 1 byte</p></div>
<h2>How does that fix it?</h2>
<p>In my best guess, the game engine probably checks the data for the tile that the player
is standing on when he moves.
If some condition passes, it will display the appropriate message in the <code>#message</code> array for that tile.
By changing <code>#message</code> to <code>#fessage</code>, there is no longer any reference to a <code>#message</code> array
when the code looks for it.
It treats it as an empty (or undefined?) object and happily displays nothing.</p>
<p>Consider this JS example:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">bar</span>) {
    <span class="hljs-keyword">if</span> (bar[<span class="hljs-string">&quot;message&quot;</span>] !== <span class="hljs-literal">undefined</span>) {
        <span class="hljs-comment">// display the message</span>
    }
}
</code></pre>
<p>Suppose we can&#x27;t change the function <code>foo()</code>, but we want to change the outcome.
We do have access to the data that is passed to it.
We can rename the passing object&#x27;s <code>message</code> property and the function will think it was never there.</p>
<h2>How did the bug happen?</h2>
<p>My best guess is that it happened because of a simple oversight.
They used a map editing tool to create each area.
They very likely copied and pasted already finished maps to new areas and then tweaked them.
That would have been easier than making them from scratch.
But since the text and event data were mixed in, they likely overlooked it in some spots
and forgot to remove it or change it.
This makes the most sense, because the bugged out dialogue often originates from
an adjacent map where it is used properly.</p>
<h2>Why did you put so much effort into something so insignificant?</h2>
<p>I don&#x27;t know. Nostalgia?</p></div></article></div></div><!--$--><!--/$--><script src="/_next/static/chunks/webpack-6b8b512d4121474e.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[9766,[],\"\"]\n3:I[8924,[],\"\"]\n5:I[4431,[],\"OutletBoundary\"]\n7:I[5278,[],\"AsyncMetadataOutlet\"]\n9:I[4431,[],\"ViewportBoundary\"]\nb:I[4431,[],\"MetadataBoundary\"]\nc:\"$Sreact.suspense\"\ne:I[7150,[],\"\"]\n:HL[\"/_next/static/css/0f63a619df29c78b.css\",\"style\"]\n:HL[\"/_next/static/css/5eacd01f773eed7f.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"lLKmyGbgC9GZXyGPxKThQ\",\"p\":\"\",\"c\":[\"\",\"ccsr-bugfix\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[[\"slug\",\"ccsr-bugfix\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/0f63a619df29c78b.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"meta\",null,{\"charSet\":\"UTF-8\"}],[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1.0\"}]]}],[\"$\",\"body\",null,{\"id\":\"main\",\"className\":\"main px-5 pb-10 max-w-5xl m-auto\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[[\"slug\",\"ccsr-bugfix\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/5eacd01f773eed7f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L5\",null,{\"children\":[\"$L6\",[\"$\",\"$L7\",null,{\"promise\":\"$@8\"}]]}]]}],{},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$L9\",null,{\"children\":\"$La\"}],null],[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$c\",null,{\"fallback\":null,\"children\":\"$Ld\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$e\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n6:null\n"])</script><script>self.__next_f.push([1,"f:I[2619,[\"619\",\"static/chunks/619-ba102abea3e3d0e4.js\",\"182\",\"static/chunks/app/%5Bslug%5D/page-a8d66757df33bd31.js\"],\"\"]\n"])</script><script>self.__next_f.push([1,"4:[\"$\",\"div\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-wrap p-1 sm:p-3\",\"children\":[[[\"$\",\"$Lf\",\"0\",{\"className\":\"mx-3 p-1 sm:px-3 sm:py-2 rounded-lg hover:bg-gray-200 transition-all font-bold\",\"href\":\"/\",\"children\":\"Blog\"}],[\"$\",\"$Lf\",\"1\",{\"className\":\"mx-3 p-1 sm:px-3 sm:py-2 rounded-lg hover:bg-gray-200 transition-all font-normal\",\"href\":\"/projects\",\"children\":\"Projects\"}],[\"$\",\"$Lf\",\"2\",{\"className\":\"mx-3 p-1 sm:px-3 sm:py-2 rounded-lg hover:bg-gray-200 transition-all font-normal\",\"href\":\"/travel\",\"children\":\"Travel\"}],[\"$\",\"$Lf\",\"3\",{\"className\":\"mx-3 p-1 sm:px-3 sm:py-2 rounded-lg hover:bg-gray-200 transition-all font-normal\",\"href\":\"/about\",\"children\":\"About Me\"}]],[\"$\",\"$Lf\",\"contact\",{\"className\":\"mx-3 p-1 sm:px-3 sm:py-2 rounded-lg hover:bg-gray-200 transition-all \",\"target\":\"_blank\",\"href\":\"https://docs.google.com/forms/d/e/1FAIpQLScM11T5L9SjhZ1c9A3OB7aWc6DuLYTzf9DStnFkalDKaKDpaA/viewform?usp=sharing\u0026ouid=112011499277324502181\",\"children\":\"Contact\"}]]}],[\"$\",\"div\",null,{\"className\":\"md:flex md:justify-center\",\"children\":[\"$\",\"article\",null,{\"className\":\"prose md:prose-lg lg:prose-xl mt-16\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"mb-0\",\"children\":\"Fixing a bug in an 18 year old Shockwave game\"}],[\"$\",\"div\",null,{\"className\":\"italic text-gray-500\",\"children\":\"The story of changing a single byte\"}],[\"$\",\"div\",null,{\"className\":\"text-gray-400\",\"children\":\"October 6, 2018\"}],[\"$\",\"div\",null,{\"className\":\"mt-6\",\"children\":[[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"It felt like unearthing a buried tomb and finding an untouched puzzle inside.\\nOne that would have otherwise been lost to time without ever being solved.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Cartoon Cartoon Summer Resort\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"It was the summer of 2000.\\nI was 6 years old, and\\nI had just passed the 1\",[\"$\",\"sup\",null,{\"children\":\"st\"}],\" grade and starting summer break.\\nThis meant long days of playing outside, watching cartoon marathons,\\nand booting up my dad's Windows 98 computer to browse for games to play\\non a brand new frontier called the \\\"Internet\\\".\\nCartoon Network's website was one of my favorites.\\nThey had immersive flash games that were designed around the cartoons on TV.\\nThat summer they released a series of games called \\\"Cartoon Cartoon Summer Resort\\\".\"]}],\"\\n\",[\"$\",\"iframe\",null,{\"width\":\"100%\",\"height\":\"400px\",\"src\":\"https://www.youtube.com/embed/JcEcJpV6Rvs\",\"allow\":\"autoplay; encrypted-media\",\"allowFullScreen\":true}],\"\\n\",[\"$\",\"div\",null,{\"className\":\"subtitle\",\"children\":[\"$\",\"p\",null,{\"children\":\"Gameplay of the first Episode of Cartoon Cartoon Summer Resort\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The game was a top-down 2D RPG/adventure game that had 4 episodes.\\nYou played as a cartoon character who is on vacation at a resort with other cartoon characters.\\nIn each episode there is a problem to solve at the resort.\\nYou must help solve it by interacting with the characters and finding/trading items.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"Fast forward 18 years\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"I remembered this game a while ago during a nostalga trip and I knew that I had to play it again.\\nThe game is nearly 2 decades old so it was hard to find a working link.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Also, no modern browser would run the ancient and vulnerability prone Shockwave player... except for Internet Explorer.\\nI may be the first person to have finally found a legitimate reason to use Internet Exploerer in 2018.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"After playing the game for a bit, There were some things that became impossible to ignore.\\nFor example, the repetitive background music that plays in an infinite loop, and the poor collision detection.\"}],\"\\n\",[\"$\",\"h2\",null,{\"children\":\"The Bug\"}],\"\\n\",\"$L10\",\"\\n\",\"$L11\",\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\",\"\\n\",\"$L25\",\"\\n\",\"$L26\",\"\\n\",\"$L27\",\"\\n\",\"$L28\",\"\\n\",\"$L29\",\"\\n\",\"$L2a\",\"\\n\",\"$L2b\",\"\\n\",\"$L2c\",\"\\n\",\"$L2d\",\"\\n\",\"$L2e\",\"\\n\",\"$L2f\",\"\\n\",\"$L30\",\"\\n\",\"$L31\",\"\\n\",\"$L32\",\"\\n\",\"$L33\",\"\\n\",\"$L34\",\"\\n\",\"$L35\",\"\\n\",\"$L36\",\"\\n\",\"$L37\",\"\\n\",\"$L38\",\"\\n\",\"$L39\",\"\\n\",\"$L3a\",\"\\n\",\"$L3b\",\"\\n\",\"$L3c\",\"\\n\",\"$L3d\",\"\\n\",\"$L3e\",\"\\n\",\"$L3f\",\"\\n\",\"$L40\",\"\\n\",\"$L41\",\"\\n\",\"$L42\",\"\\n\",\"$L43\",\"\\n\",\"$L44\"]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"8:{\"metadata\":[[\"$\",\"title\",\"0\",{\"children\":\"Fixing a bug in an 18 year old Shockwave game - Matt's Blog\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"The story of changing a single byte\"}]],\"error\":null,\"digest\":\"$undefined\"}\nd:\"$8:metadata\"\n"])</script><script>self.__next_f.push([1,"10:[\"$\",\"p\",null,{\"children\":\"After a while I discovered a bug in the game:\"}]\n11:[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Walking in areas where nothing should happen would sometimes prompt game dialogue to appear.\"}]}]\n12:[\"$\",\"p\",null,{\"children\":\"As you can see below, you are able to rent a boat in the game to travel on the water.\\nWhen trying to rent another boat, it says \\\"No more boats to rent today!\\\".\\nIf you travel north and walk along the right edge of the island,\\nit will randomly trigger the same text that was meant for the boat dock.\"}]\n13:[\"$\",\"div\",null,{\"className\":\"image-row\",\"children\":[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/ccsr-bugfix/bug.gif\",\"alt\":\"\"}]}]}]\n14:[\"$\",\"p\",null,{\"children\":\"Now at this point, any sane person with a healthy respsect for their time and energy\\nwould write this off as a mild annoyance, remind themselves that\\nthis was a low-budget web game made for children 2 decades ago, and continue playing.\\nBut not me.\"}]\n15:[\"$\",\"p\",null,{\"children\":[\"Looking at the game with the knowledge I now have of programming,\\nI found this ancient bug oddly mesmerizing.\\nIt felt like unearthing a buried tomb and finding an untouched puzzle inside.\\nOne that would have otherwise been lost to time without ever being solved.\\nFor me, fixing this bug was an opportunity for learning and discovery.\\nInterestingly, this is exactly what \",[\"$\",\"em\",null,{\"children\":\"playing\"}],\" the game offered to me as a kid.\\nIt's poetic how something can unintentionally offer entirely new challenges depending on how you look at it.\"]}]\n16:[\"$\",\"h2\",null,{\"children\":\"Deconstructing the Game\"}]\n"])</script><script>self.__next_f.push([1,"17:[\"$\",\"p\",null,{\"children\":[\"In order to fix the bug, I needed to figure out how the game worked under the hood.\\nAfter doing some research, I learned that the game was a Shockwave game made with \",[\"$\",\"a\",null,{\"href\":\"https://en.wikipedia.org/wiki/Adobe_Director\",\"target\":\"_blank\",\"className\":\"underline\",\"children\":\"Director\"}],\".\\nWhen using Director, projects are saved as a \",[\"$\",\"code\",null,{\"children\":\".dir\"}],\" (Director) file.\\nThis file is similar to a PSD file for Photoshop.\\nIn the same way that a PSD file would hold non-destructive layer and text information,\\nthe \",[\"$\",\"code\",null,{\"children\":\".dir\"}],\" project saves all assets, raw source code, and other information to aide in the development process.\\nDirector used a proprietary scripting language called\\n\",[\"$\",\"a\",null,{\"href\":\"https://en.wikipedia.org/wiki/Lingo_(programming_language)\",\"target\":\"_blank\",\"children\":\"Lingo\"}],\"\\nto animate scenes.\"]}]\n"])</script><script>self.__next_f.push([1,"18:[\"$\",\"p\",null,{\"children\":[\"If the game was saved as a \",[\"$\",\"code\",null,{\"children\":\".dir\"}],\" file, I would simply be able to open it\\nin Director and easily see how the game works.\\nHowever, the game was published as a \",[\"$\",\"code\",null,{\"children\":\".dcr\"}],\" file.\\nThe \",[\"$\",\"code\",null,{\"children\":\".dcr\"}],\" file is a compiled version of a Director project.\\nThis means that all of the source code has been compiled into bytecode that runs on the Shockwave platform.\\nThis process is similar to how a PSD file can be flattened into a PNG image.\\nThe PNG image (DCR file in this case) is smaller, has no layer or editing information, and is only meant to be distributed.\"]}]\n"])</script><script>self.__next_f.push([1,"19:[\"$\",\"p\",null,{\"children\":\"This meant that I was stuck with a 500kB binary blob with no documentation on how it was structured.\\nEven if I did figure out how to find the low-level bytecode,\\nit didn't look like there was anyone who\\nhad reverse engineered Lingo bytecode or even documented how the Shockwave platform works.\\nAll of this information is proprietary and owned by Adobe who has no reason to release it.\\nThe prospects of figuring out how this game worked were looking pretty grim.\"}]\n1a:[\"$\",\"h2\",null,{\"children\":\"Decompression\"}]\n1b:[\"$\",\"p\",null,{\"children\":[\"After feeling defeated by the fact that I wasn't likely going to be able to solve the bug, I decided\\nto see if there was any possible way to extract assets out of the game.\\nI figured that there might be a chance I could find a compressed data section or something similar.\\nAfter looking around, I found a few programs called \",[\"$\",\"a\",null,{\"href\":\"https://aluigi.altervista.org/mytoolz.htm\",\"target\":\"_blank\",\"className\":\"underline\",\"children\":\"offzip and packzip\"}],\".\\nThese tools are able to search for zlib data in arbitrary binary files, show you the offsets,\\nand extract them to separate files if they exist.\"]}]\n1c:[\"$\",\"p\",null,{\"children\":\"I ran offzip on the DCR file and to my amazement it actually found archives!\\n249 to be exact.\"}]\n"])</script><script>self.__next_f.push([1,"1d:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-apache\",\"children\":[\"$$ ./\",[\"$\",\"span\",null,{\"className\":\"hljs-attribute\",\"children\":\"offzip\"}],\".exe -a \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\".dcr\\n\\n- \",[\"$\",\"span\",null,{\"className\":\"hljs-attribute\",\"children\":\"open\"}],\" input file:    \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\".dcr\\n- \",[\"$\",\"span\",null,{\"className\":\"hljs-attribute\",\"children\":\"zip\"}],\" data to check:  \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"32\"}],\" bytes\\n- \",[\"$\",\"span\",null,{\"className\":\"hljs-attribute\",\"children\":\"zip\"}],\" windowBits:     \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"15\"}],\"\\n- \",[\"$\",\"span\",null,{\"className\":\"hljs-attribute\",\"children\":\"seek\"}],\" offset:        \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"x00000000  (\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\")\\n+------------+-----+----------------------------+----------------------+\\n| \",[\"$\",\"span\",null,{\"className\":\"hljs-attribute\",\"children\":\"hex_offset\"}],\" | ... | zip -\u003e unzip size / offset | spaces before | info |\\n+------------+-----+----------------------------+----------------------+\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attribute\",\"children\":\"0x00000026\"}],\" . \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"164\"}],\" -\u003e \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"214\"}],\" / \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"x000000ca _ \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"38\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"8\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"7\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"26\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"7\"}],\"b6349f6\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attribute\",\"children\":\"0x000000d3\"}],\" .. \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"3932\"}],\" -\u003e \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"9169\"}],\" / \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"x0000102f _ \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"9\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"8\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"7\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"26\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\":c1079d84\\n  ...\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attribute\",\"children\":\"0x00080490\"}],\" . \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"265\"}],\" -\u003e \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"472\"}],\" / \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"x00080599 _ \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"8\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"7\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"26\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"04\"}],\"d6b43f\\n  \",[\"$\",\"span\",null,{\"className\":\"hljs-attribute\",\"children\":\"0x00080599\"}],\" . \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"209\"}],\" -\u003e \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"366\"}],\" / \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"x0008066a _ \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"8\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"7\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"26\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\":\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"7\"}],\"da3ba08\\n\\n\\n- \",[\"$\",\"span\",null,{\"className\":\"hljs-attribute\",\"children\":\"249\"}],\" valid compressed streams found\\n- \",[\"$\",\"span\",null,{\"className\":\"hljs-attribute\",\"children\":\"0x0004040d\"}],\" -\u003e \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"x001565c8 bytes covering the \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"50\"}],\"% of the file\\n\"]}]}]\n"])</script><script>self.__next_f.push([1,"1e:[\"$\",\"p\",null,{\"children\":[\"I extracted all of these files into a folder, and started looking at the results.\\nThere were 206 \",[\"$\",\"code\",null,{\"children\":\".dat\"}],\" files, 38 \",[\"$\",\"code\",null,{\"children\":\".fff\"}],\" files, 4 \",[\"$\",\"code\",null,{\"children\":\".atn\"}],\" files, and a single \",[\"$\",\"code\",null,{\"children\":\".ini\"}],\" file.\"]}]\n1f:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/ccsr-bugfix/decomp.png\",\"alt\":\"\"}]}]\n20:[\"$\",\"h2\",null,{\"children\":\"Discoveries\"}]\n21:[\"$\",\"p\",null,{\"children\":\"I started with the INI file, but it had no value.\\nIt was just a font mapping table for Directory 7.0 between Windows and Mac.\\nNext I moved on to the DAT files.\\nMost of these were 1KB in size, so I started with the huge one that was\\n144KB in size.\\nI opened it in a hex editor and looked around.\\nMost of it was unintelligible data.\\nHowever, eventually I found some words mixed in that appeared to be Lingo identifiers\"}]\n22:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/ccsr-bugfix/lingohex.png\",\"alt\":\"\"}]}]\n23:[\"$\",\"p\",null,{\"children\":[\"Sifting through the large DAT files provided me with a few clues,\\nand there were some interesting messages littered throughout it.\\nI found out that they likely used Photoshop 3.0 for the graphics.\\nThey also had an internal map editing tool that was named\\n\",[\"$\",\"code\",null,{\"children\":\"Map-O-Matic v1\"}],\". I wish I could see what that looked like\\nand how it was made.\"]}]\n24:[\"$\",\"p\",null,{\"children\":[\"I also discovered the name of the company who made the game:\\n\",[\"$\",\"a\",null,{\"href\":\"https://www.linkedin.com/company/funny-garbage/\",\"target\":\"_blank\",\"className\":\"underline\",\"children\":\"Funny Garbage\"}],\".\\nThe lead developer's name was also in the file, who's name I will omit.\\nIt felt good to solve the mystery of who made the game that I was furiously\\ntrying to fix nearly 20 years later and to put a face to the person\\nwho likely caused me this agony.\\nAll of these tidbits of information were nice to find,\\nbut they weren't that helpful.\"]}]\n25:[\"$"])</script><script>self.__next_f.push([1,"\",\"h2\",null,{\"children\":\"Breakthrough\"}]\n26:[\"$\",\"p\",null,{\"children\":[\"Next, I looked at the \",[\"$\",\"code\",null,{\"children\":\".fff\"}],\" files in the hex editor.\\nTo my great surprise, all of the data in these files\\nwas legible AND it looked like map data:\"]}]\n27:[\"$\",\"div\",null,{\"className\":\"image-row\",\"children\":[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/ccsr-bugfix/maphex.png\",\"alt\":\"\"}]}]}]\n28:[\"$\",\"p\",null,{\"children\":\"I manually extracted some of this data and prettied it up in a text editor.\\nWhat I was left with was something that looks very similar to a JSON array:\"}]\n"])</script><script>self.__next_f.push([1,"29:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"hljs language-smalltalk\",\"children\":[\"[\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#member\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"block.104\\\"\"}],\",\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#type\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#FLOR\"}],\",\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#location\"}],\": [\",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"16\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"9\"}],\"],\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#width\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"64\"}],\",\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#WSHIFT\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\",\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#height\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"32\"}],\",\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#HSHIFT\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\",\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#data\"}],\": [\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#item\"}],\": [\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#name\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"\\\"\"}],\",\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#type\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#WALL\"}],\",\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#visi\"}],\": [\\n                \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#visiObj\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"\\\"\"}],\",\\n                \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#visiAct\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"\\\"\"}],\",\\n                \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#inviObj\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"\\\"\"}],\",\\n                \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#inviAct\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"\\\"\"}],\"\\n            ],\\n            \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#COND\"}],\": [[\",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#hasObj\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"\\\"\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#hasAct\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"\\\"\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#giveObj\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"sunscreen\\\"\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#giveAct\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"gotscreen\\\"\"}],\"], \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#none\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#none\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#none\"}],\"]\\n        ],\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#move\"}],\": [\",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#U\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#d\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#L\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#R\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#COND\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"1\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#TIMEA\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#TIMEB\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-number\",\"children\":\"0\"}],\"],\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#message\"}],\": [\\n            [\",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#text\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"You bought the sun screen.\\\"\"}],\", \",[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#plrObj\"}],\": \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"\\\"\"}],\", \",\"$L45\",\": \",\"$L46\",\"],\\n            [\",\"$L47\",\": \",\"$L48\",\", \",\"$L49\",\": \",\"$L4a\",\", \",\"$L4b\",\": \",\"$L4c\",\"]\\n        ]\\n    ]\\n]\\n\"]}]}]\n"])</script><script>self.__next_f.push([1,"2a:[\"$\",\"p\",null,{\"children\":\"This was critical, because I was able to deduce a lot about how the game worked from this.\"}]\n2b:[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"The game expects its map, text, and event data in JSON-like Lingo Objects\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Each \",[\"$\",\"code\",null,{\"children\":\"#member\"}],\" entry is a tile, block, or character to be rendered.\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"#member\"}],\"'s location offsets and dimensions are editable.\"]}],\"\\n\"]}]\n2c:[\"$\",\"p\",null,{\"children\":[\"Knowing that the game dialoge is saved in these files,\\nI wrote a quick line to extract only the dialogue into a file:\\n\",[\"$\",\"code\",null,{\"children\":\"grep -a -o '#text: \\\"[^\\\"]*' Uncompressed/*.fff | awk '{print $0,\\\"\\\\r\\\"}' \u003e Dialogue.txt\"}]]}]\n2d:[\"$\",\"p\",null,{\"children\":\"Using this file, I could easily search for the offending text,\\nand also see which file it was in:\"}]\n2e:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/ccsr-bugfix/dialogue.png\",\"alt\":\"\"}]}]\n2f:[\"$\",\"p\",null,{\"children\":[\"The offending text is either in \",[\"$\",\"code\",null,{\"children\":\"0004eda0.fff\"}],\" or \",[\"$\",\"code\",null,{\"children\":\"0004f396.fff\"}],\".\\nIn this case, the bugged text is in the first file.\\nWe know this because right under it is the message that you get\\nwhen interacting with Og, who is the character in the same map as the bugged tile.\"]}]\n30:[\"$\",\"h2\",null,{\"children\":\"Fixing the Bug\"}]\n31:[\"$\",\"p\",null,{\"children\":[\"Now, I can open \",[\"$\",\"code\",null,{\"children\":\"0004eda0.fff\"}],\" and search for the boat string in the hex editor.\\nOnce I find that, I can find the \",[\"$\",\"code\",null,{\"children\":\"#member\"}],\" object that's associated with it.\\nI can now change its properties and save the file.\\nAfterwards, I can recompress and patch it back into the original game DCR by using \",[\"$\",\"code\",null,{\"children\":\"packzip\"}],\".\"]}]\n32:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/ccsr-bugfix/boathex1.png\",\"alt\":\"\"}]}]\n33:[\"$\",\"p\",null,{\"c"])</script><script>self.__next_f.push([1,"hildren\":[\"$\",\"code\",null,{\"children\":\"$$ ./packzip -o 0x0004EDA0 Uncompressed/0004eda0.fff test.dcr\"}]}]\n34:[\"$\",\"p\",null,{\"children\":[\"When I change the block type from \",[\"$\",\"code\",null,{\"children\":\"block.11\"}],\" to \",[\"$\",\"code\",null,{\"children\":\"block.13\"}],\" and patch the game,\\nwe can clearly see the outline of the messed up tile:\"]}]\n35:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/ccsr-bugfix/replace.png\",\"alt\":\"\"}]}]\n36:[\"$\",\"div\",null,{\"className\":\"subtitle\",\"children\":[\"$\",\"p\",null,{\"children\":\"Changing the tile ID shows the bounds of the bugged area\"}]}]\n37:[\"$\",\"p\",null,{\"children\":[\"The actual fix for the bug is laughably simple.\\nAll I had to do was change the identifier for the \",[\"$\",\"code\",null,{\"children\":\"#message\"}],\" to \",[\"$\",\"code\",null,{\"children\":\"#fessage\"}],\" for that bugged tile:\"]}]\n38:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/ccsr-bugfix/bugfix.gif\",\"alt\":\"\"}]}]\n39:[\"$\",\"p\",null,{\"children\":\"Now, when we patch this in and walk back to that area,\\nTHERE ARE NO MORE MESSAGES!!!\"}]\n3a:[\"$\",\"p\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/images/ccsr-bugfix/fixed.gif\",\"alt\":\"\"}]}]\n3b:[\"$\",\"div\",null,{\"className\":\"subtitle\",\"children\":[\"$\",\"p\",null,{\"children\":\"Fixing a bug in the game by literally editing 1 byte\"}]}]\n3c:[\"$\",\"h2\",null,{\"children\":\"How does that fix it?\"}]\n3d:[\"$\",\"p\",null,{\"children\":[\"In my best guess, the game engine probably checks the data for the tile that the player\\nis standing on when he moves.\\nIf some condition passes, it will display the appropriate message in the \",[\"$\",\"code\",null,{\"children\":\"#message\"}],\" array for that tile.\\nBy changing \",[\"$\",\"code\",null,{\"children\":\"#message\"}],\" to \",[\"$\",\"code\",null,{\"children\":\"#fessage\"}],\", there is no longer any reference to a \",[\"$\",\"code\",null,{\"children\":\"#message\"}],\" array\\nwhen the code looks for it.\\nIt treats it as an empty (or undefined?) object and happily displays nothing.\"]}]\n3e:[\"$\",\"p\",null,{\"children\":\"Consider this JS example:\"}]\n3f:[\"$\",\"pre\",null,{\"children\":[\"$\",\"cod"])</script><script>self.__next_f.push([1,"e\",null,{\"className\":\"hljs language-js\",\"children\":[[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"function\"}],\" \",[\"$\",\"span\",null,{\"className\":\"hljs-title function_\",\"children\":\"foo\"}],\"(\",[\"$\",\"span\",null,{\"className\":\"hljs-params\",\"children\":\"bar\"}],\") {\\n    \",[\"$\",\"span\",null,{\"className\":\"hljs-keyword\",\"children\":\"if\"}],\" (bar[\",[\"$\",\"span\",null,{\"className\":\"hljs-string\",\"children\":\"\\\"message\\\"\"}],\"] !== \",[\"$\",\"span\",null,{\"className\":\"hljs-literal\",\"children\":\"undefined\"}],\") {\\n        \",[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"// display the message\"}],\"\\n    }\\n}\\n\"]}]}]\n40:[\"$\",\"p\",null,{\"children\":[\"Suppose we can't change the function \",[\"$\",\"code\",null,{\"children\":\"foo()\"}],\", but we want to change the outcome.\\nWe do have access to the data that is passed to it.\\nWe can rename the passing object's \",[\"$\",\"code\",null,{\"children\":\"message\"}],\" property and the function will think it was never there.\"]}]\n41:[\"$\",\"h2\",null,{\"children\":\"How did the bug happen?\"}]\n42:[\"$\",\"p\",null,{\"children\":\"My best guess is that it happened because of a simple oversight.\\nThey used a map editing tool to create each area.\\nThey very likely copied and pasted already finished maps to new areas and then tweaked them.\\nThat would have been easier than making them from scratch.\\nBut since the text and event data were mixed in, they likely overlooked it in some spots\\nand forgot to remove it or change it.\\nThis makes the most sense, because the bugged out dialogue often originates from\\nan adjacent map where it is used properly.\"}]\n43:[\"$\",\"h2\",null,{\"children\":\"Why did you put so much effort into something so insignificant?\"}]\n44:[\"$\",\"p\",null,{\"children\":\"I don't know. Nostalgia?\"}]\n"])</script><script>self.__next_f.push([1,"45:[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#plrAct\"}]\n46:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"\\\"\"}]\n47:[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#text\"}]\n48:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"No more sunscreen today!\\\"\"}]\n49:[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#plrObj\"}]\n4a:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"\\\"\"}]\n4b:[\"$\",\"span\",null,{\"className\":\"hljs-symbol\",\"children\":\"#plrAct\"}]\n4c:[\"$\",\"span\",null,{\"className\":\"hljs-comment\",\"children\":\"\\\"gotscreen\\\"\"}]\n"])</script></body></html>